Scientific Project Description for Neural Network ImplementationProject OverviewThis project involves building a neural network model designed to forecast variations in the Earth's surface magnetic field. The model integrates data from two distinct branches:* Branch 1 (Large-scale dynamics): Utilizes solar wind and global-scale geophysical data.* Branch 2 (Small-scale dynamics): Employs detailed ground-based magnetometer data processed with the Spherical Elementary Current Systems (SECS) method.The goal is to predict magnetic field variations at the central point of a 21?21 SECS grid for forecast intervals ranging from 1 to 30 minutes ahead.Data Description and OrganizationTarget Data* Predictions will focus on three magnetic field components (Be, Bn, Bu) at the grid center.* Target data is stored in CSV format with filenames corresponding to date and time (e.g., Be_20240120_235400.csv).* Files contain magnetic field values for all points in the 21?21 SECS grid.* The data is organized by magnetic field component (Be, Bn, Bu) and located in:/Users/akv020/Tensorflow/fennomag-net/data/secs/test_mode_2024Branch 1: Large-Scale Solar and Geophysical Data* Purpose: Captures broad interactions between solar and terrestrial systems for long-duration forecasting.* Data: Stored in a CSV file at:/Users/akv020/Tensorflow/fennomag-net/data/geophysical/geodata.csv* Timeframe: Data spans from January 1, 2010, to December 31, 2024, recorded every 15 minutes.* Data Features (columns):1. DateTime Ð not a feature just provides the observation date time information2. SME 3. SML 4. SMU 5. SYM_D 6. SYM_H 7. ASY_D 8. ASY_H 9. Sunspot 10. f107 11. ap_index 12. Lyman 13. DOY_cos 14. DOY_sin 15. SolarZenithAngle 16. TOD_cos 17. TOD_sin* Data Preprocessing:o Chronologically split into training (70%), validation (15%), and testing (15%) datasets.o 24-hour lookback windows (96 timesteps) created using a sliding window every 15 minutes.o Data saved in TFRecord format for efficient data handling during model training.Branch 2: Small-Scale SECS-based Magnetometer Data* Purpose: Captures rapid ionospheric variations essential for short-term forecasting.* Data Format: Stored as RGB .png images representing magnetic field components.* Location:/Users/akv020/Tensorflow/fennomag-net/data/secs/test_mode_2024/figures* Naming Convention: Images named by date-time (e.g., 20240101_000000.png), with a resolution of one minute.* Data Dimensions: (21?21?3?180) representing spatial dimensions, RGB channels for magnetic components, and 180 timesteps (3 hours at 1-minute intervals).* Initial Testing: First-stage testing will use data from the year 2024 only.Methodology and Network ArchitectureModel StructureThe neural network follows a three-stage process:* Stage 1: Feature Extractiono Branch 1 data processed via LSTM networks to generate embeddings (B1).o Branch 2 data processed via ConvLSTM to generate embeddings (B2).* Stage 2: Cross-Attention Fusiono Combines embeddings using cross-attention mechanisms, allowing detailed querying between Branch 1 and Branch 2.o Produces a combined embedding (B_att) to capture global-local interactions explicitly.* Stage 3: Decoder for Prediction Outputo Combined embedding is processed through CNN or fully connected layers.o Output: Predictions of magnetic field components at the grid center for horizons of 1, 5, 10, 15, and up to 30 minutes.o Output shape: (3 magnetic field components ? number of prediction horizons).Implementation Guidelines for Developers* Clearly separate preprocessing steps for Branch 1 (time series) and Branch 2 (image data).* Maintain modular code structures, particularly for embedding extraction and attention mechanisms.* Utilize Multi-Head Cross-Attention layers for interpretability.* Document all code thoroughly, especially attention-related modules, to ensure ease of understanding and reproducibility.* Allow for experimentation by making embedding sizes adjustable.Expected Benefits* Improved forecasting accuracy through explicit modeling of interactions between global and local geophysical dynamics.* Robust model performance despite heterogeneous data types.* Increased interpretability through attention visualization tools, aiding in understanding and diagnosing model predictions.